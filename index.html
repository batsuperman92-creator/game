<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ğŸŒ ìˆ˜ë„ ë§íˆê¸° ê²Œì„ (PWA, íƒ€ì´ë¨¸+ìë™ìŠ¤í¬ë¡¤)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#317EFB" />
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin: 0; padding: 20px; }
    h1 { font-size: 1.8em; }
    input { padding: 12px; width: 80%; font-size: 1.1em; margin-top: 10px; }
    #status { margin-top: 12px; font-weight: bold; min-height: 1.4em; }
    #lives, #score, #timer { margin-top: 8px; font-size: 1.05em; }
    #headerRow { display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top: 8px; }
    #history {
      margin: 16px auto 0;
      height: 40vh;                 /* ëª¨ë°”ì¼ì—ì„œë„ ë³´ê¸° ì¢‹ê²Œ ê³ ì • ë†’ì´ */
      max-height: 420px;
      width: min(700px, 92vw);
      overflow-y: auto;              /* ê¸°ë¡ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
      -webkit-overflow-scrolling: touch; /* iOS ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ */
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 10px;
      text-align: left;
      font-size: 0.95em;
      line-height: 1.5;
      box-sizing: border-box;
    }
    #ranking { margin-top: 22px; text-align: left; display: inline-block; font-size: 1em; }
    .muted { opacity: .7; }
  </style>
</head>
<body>
  <h1>ğŸŒ ìˆ˜ë„ ë§íˆê¸° ê²Œì„</h1>
  <p class="muted">ë‚˜ë¼ ì´ë¦„ì´ ë‚˜ì˜¤ë©´ ìˆ˜ë„ë¥¼ ì…ë ¥í•˜ê³  <b>ì—”í„°</b>ë¥¼ ëˆ„ë¥´ì„¸ìš”! (ì²˜ìŒ ì—”í„°ë¥¼ ëˆ„ë¥´ë©´ íƒ€ì´ë¨¸ ì‹œì‘)</p>

  <input type="text" id="answerInput" placeholder="ìˆ˜ë„ ì…ë ¥" autocomplete="off" />
  <p id="question">ê²Œì„ ì‹œì‘! ì—”í„°ë¥¼ ëˆŒëŸ¬ ì²« ë¬¸ì œë¥¼ ë°›ì•„ë³´ì„¸ìš”.</p>

  <div id="headerRow">
    <span id="status"></span>
    <span id="score">âœ… ì •ë‹µ ìˆ˜: 0ê°œ</span>
    <span id="lives">âŒ í‹€ë¦° íšŸìˆ˜: 0 / 10</span>
    <span id="timer">â± ë‚¨ì€ ì‹œê°„: 02:00</span>
  </div>

  <div id="history" aria-live="polite"></div>

  <div id="ranking">
    <h2>ğŸ† ë¡œì»¬ ë­í‚¹ (Top 10)</h2>
    <ol id="rankingList"></ol>
  </div>

  <script>
    // 190ì—¬ ê°œ ë‚˜ë¼ì™€ ìˆ˜ë„ (UN íšŒì›êµ­ ê¸°ì¤€)
    const quizData = {
      "ì•„í”„ê°€ë‹ˆìŠ¤íƒ„":"ì¹´ë¶ˆ","ì•Œë°”ë‹ˆì•„":"í‹°ë¼ë‚˜","ì•Œì œë¦¬":"ì•Œì œ","ì•ˆë„ë¼":"ì•ˆë„ë¼ë¼ë²¨ë¼","ì•™ê³¨ë¼":"ë£¨ì•ˆë‹¤",
      "ì•ˆí‹°êµ¬ì•„ ë°”ë¶€ë‹¤":"ì„¸ì¸íŠ¸ì¡´ìŠ¤","ì•„ë¥´í—¨í‹°ë‚˜":"ë¶€ì—ë…¸ìŠ¤ì•„ì´ë ˆìŠ¤","ì•„ë¥´ë©”ë‹ˆì•„":"ì˜ˆë ˆë°˜","í˜¸ì£¼":"ìº”ë²„ë¼",
      "ì˜¤ìŠ¤íŠ¸ë¦¬ì•„":"ë¹ˆ","ì•„ì œë¥´ë°”ì´ì”":"ë°”ì¿ ","ë°”í•˜ë§ˆ":"ë‚˜ì†Œ","ë°”ë ˆì¸":"ë§ˆë‚˜ë§ˆ","ë°©ê¸€ë¼ë°ì‹œ":"ë‹¤ì¹´",
      "ë°”ë² ì´ë„ìŠ¤":"ë¸Œë¦¬ì§€íƒ€ìš´","ë²¨ë¼ë£¨ìŠ¤":"ë¯¼ìŠ¤í¬","ë²¨ê¸°ì—":"ë¸Œë¤¼ì…€","ë²¨ë¦¬ì¦ˆ":"ë²¨ëª¨íŒ","ë² ëƒ‰":"í¬ë¥´í† ë…¸ë³´",
      "ë¶€íƒ„":"íŒ€ë¶€","ë³¼ë¦¬ë¹„ì•„":"ìˆ˜í¬ë ˆ","ë³´ìŠ¤ë‹ˆì•„ í—¤ë¥´ì²´ê³ ë¹„ë‚˜":"ì‚¬ë¼ì˜ˆë³´","ë³´ì¸ ì™€ë‚˜":"ê°€ë³´ë¡œë„¤","ë¸Œë¼ì§ˆ":"ë¸Œë¼ì§ˆë¦¬ì•„",
      "ë¸Œë£¨ë‚˜ì´":"ë°˜ë‹¤ë¥´ìŠ¤ë¦¬ë¸Œê°€ì™„","ë¶ˆê°€ë¦¬ì•„":"ì†Œí”¼ì•„","ë¶€ë¥´í‚¤ë‚˜íŒŒì†Œ":"ì™€ê°€ë‘êµ¬","ë¶€ë£¬ë””":"ê¸°í…Œê°€",
      "ì¹´ë³´ë² ë¥´ë°":"í”„ë¼ì´ì•„","ìº„ë³´ë””ì•„":"í”„ë†ˆíœ","ì¹´ë©”ë£¬":"ì•¼ìš´ë°","ìºë‚˜ë‹¤":"ì˜¤íƒ€ì™€","ì¤‘ì•™ì•„í”„ë¦¬ì¹´ê³µí™”êµ­":"ë°©ê¸°",
      "ì°¨ë“œ":"ì€ìë©”ë‚˜","ì¹ ë ˆ":"ì‚°í‹°ì•„ê³ ","ì¤‘êµ­":"ë² ì´ì§•","ì½œë¡¬ë¹„ì•„":"ë³´ê³ íƒ€","ì½”ëª¨ë¡œ":"ëª¨ë¡œë‹ˆ","ì½©ê³ ê³µí™”êµ­":"ë¸Œë¼ìë¹Œ",
      "ì½©ê³ ë¯¼ì£¼ê³µí™”êµ­":"í‚¨ìƒ¤ì‚¬","ì½”ìŠ¤íƒ€ë¦¬ì¹´":"ì‚°í˜¸ì„¸","ì½”íŠ¸ë””ë¶€ì•„ë¥´":"ì•¼ë¬´ìˆ˜í¬ë¡œ","í¬ë¡œì•„í‹°ì•„":"ìê·¸ë ˆë¸Œ","ì¿ ë°”":"ì•„ë°”ë‚˜",
      "í‚¤í”„ë¡œìŠ¤":"ë‹ˆì½”ì‹œì•„","ì²´ì½”":"í”„ë¼í•˜","ë´ë§ˆí¬":"ì½”íœí•˜ê²","ì§€ë¶€í‹°":"ì§€ë¶€í‹°","ë„ë¯¸ë‹ˆì¹´":"ë¡œì¡°",
      "ë„ë¯¸ë‹ˆì¹´ê³µí™”êµ­":"ì‚°í† ë„ë°ê³ ","ë™í‹°ëª¨ë¥´":"ë”œë¦¬","ì—ì½°ë„ë¥´":"í‚¤í† ","ì´ì§‘íŠ¸":"ì¹´ì´ë¡œ","ì—˜ì‚´ë°”ë„ë¥´":"ì‚°ì‚´ë°”ë„ë¥´",
      "ì ë„ê¸°ë‹ˆ":"ë§ë¼ë³´","ì—ë¦¬íŠ¸ë ˆì•„":"ì•„ìŠ¤ë§ˆë¼","ì—ìŠ¤í† ë‹ˆì•„":"íƒˆë¦°","ì—ìŠ¤ì™€í‹°ë‹ˆ":"ìŒë°”ë°”ë„¤","ì—í‹°ì˜¤í”¼ì•„":"ì•„ë””ìŠ¤ì•„ë°”ë°”",
      "í”¼ì§€":"ìˆ˜ë°”","í•€ë€ë“œ":"í—¬ì‹±í‚¤","í”„ë‘ìŠ¤":"íŒŒë¦¬","ê°€ë´‰":"ë¦¬ë¸Œë¥´ë¹Œ","ê°ë¹„ì•„":"ë°˜ì¤„","ì¡°ì§€ì•„":"íŠ¸ë¹Œë¦¬ì‹œ","ë…ì¼":"ë² ë¥¼ë¦°",
      "ê°€ë‚˜":"ì•„í¬ë¼","ê·¸ë¦¬ìŠ¤":"ì•„í…Œë„¤","ê·¸ë ˆë‚˜ë‹¤":"ì„¸ì¸íŠ¸ì¡°ì§€ìŠ¤","ê³¼í…Œë§ë¼":"ê³¼í…Œë§ë¼ì‹œí‹°","ê¸°ë‹ˆ":"ì½”ë‚˜í¬ë¦¬",
      "ê¸°ë‹ˆë¹„ì‚¬ìš°":"ë¹„ì‚¬ìš°","ê°€ì´ì•„ë‚˜":"ì¡°ì§€íƒ€ìš´","ì•„ì´í‹°":"í¬ë¥´í† í”„ë­ìŠ¤","ì˜¨ë‘ë¼ìŠ¤":"í…Œêµ¬ì‹œê°ˆíŒŒ","í—ê°€ë¦¬":"ë¶€ë‹¤í˜ìŠ¤íŠ¸",
      "ì•„ì´ìŠ¬ë€ë“œ":"ë ˆì´ìº¬ë¹„í¬","ì¸ë„":"ë‰´ë¸ë¦¬","ì¸ë„ë„¤ì‹œì•„":"ìì¹´ë¥´íƒ€","ì´ë€":"í…Œí—¤ë€","ì´ë¼í¬":"ë°”ê·¸ë‹¤ë“œ",
      "ì•„ì¼ëœë“œ":"ë”ë¸”ë¦°","ì´ìŠ¤ë¼ì—˜":"ì˜ˆë£¨ì‚´ë ˜","ì´íƒˆë¦¬ì•„":"ë¡œë§ˆ","ìë©”ì´ì¹´":"í‚¹ìŠ¤í„´","ì¼ë³¸":"ë„ì¿„","ìš”ë¥´ë‹¨":"ì•”ë§Œ",
      "ì¹´ìíìŠ¤íƒ„":"ì•„ìŠ¤íƒ€ë‚˜","ì¼€ëƒ":"ë‚˜ì´ë¡œë¹„","í‚¤ë¦¬ë°”ì‹œ":"íƒ€ë¼ì™€","ëŒ€í•œë¯¼êµ­":"ì„œìš¸","ì¿ ì›¨ì´íŠ¸":"ì¿ ì›¨ì´íŠ¸ì‹œí‹°",
      "í‚¤ë¥´ê¸°ìŠ¤ìŠ¤íƒ„":"ë¹„ìŠˆì¼€í¬","ë¼ì˜¤ìŠ¤":"ë¹„ì—”í‹°ì•ˆ","ë¼íŠ¸ë¹„ì•„":"ë¦¬ê°€","ë ˆë°”ë…¼":"ë² ì´ë£¨íŠ¸","ë ˆì†Œí† ":"ë§ˆì„¸ë£¨",
      "ë¼ì´ë² ë¦¬ì•„":"ëª¬ë¡œë¹„ì•„","ë¦¬ë¹„ì•„":"íŠ¸ë¦¬í´ë¦¬","ë¦¬íˆí…ìŠˆíƒ€ì¸":"íŒŒë‘ì¸ ","ë¦¬íˆ¬ì•„ë‹ˆì•„":"ë¹Œë‰´ìŠ¤","ë£©ì…ˆë¶€ë¥´í¬":"ë£©ì…ˆë¶€ë¥´í¬",
      "ë§ˆë‹¤ê°€ìŠ¤ì¹´ë¥´":"ì•ˆíƒ€ë‚˜ë‚˜ë¦¬ë³´","ë§ë¼ìœ„":"ë¦´ë¡±ê¶¤","ë§ë ˆì´ì‹œì•„":"ì¿ ì•Œë¼ë£¸í‘¸ë¥´","ëª°ë””ë¸Œ":"ë§ë ˆ","ë§ë¦¬":"ë°”ë§ˆì½”",
      "ëª°íƒ€":"ë°œë ˆíƒ€","ë§ˆì…œì œë„":"ë§ˆì£¼ë¡œ","ëª¨ë¦¬íƒ€ë‹ˆ":"ëˆ„ì•…ì‡¼íŠ¸","ëª¨ë¦¬ì…”ìŠ¤":"í¬íŠ¸ë£¨ì´ìŠ¤","ë©•ì‹œì½”":"ë©•ì‹œì½”ì‹œí‹°",
      "ë¯¸í¬ë¡œë„¤ì‹œì•„":"íŒ”ë¦¬í‚¤ë¥´","ëª°ë„ë°”":"í‚¤ì‹œë„ˆìš°","ëª¨ë‚˜ì½”":"ëª¨ë‚˜ì½”","ëª½ê³¨":"ìš¸ë€ë°”í† ë¥´","ëª¬í…Œë„¤ê·¸ë¡œ":"í¬ë“œê³ ë¦¬ì°¨",
      "ëª¨ë¡œì½”":"ë¼ë°”íŠ¸","ëª¨ì ë¹„í¬":"ë§ˆí‘¸í† ","ë¯¸ì–€ë§ˆ":"ë„¤í”¼ë„","ë‚˜ë¯¸ë¹„ì•„":"ë¹ˆíŠ¸í›„í¬","ë„¤íŒ”":"ì¹´íŠ¸ë§Œë‘",
      "ë„¤ëœë€ë“œ":"ì•”ìŠ¤í…Œë¥´ë‹´","ë‰´ì§ˆëœë“œ":"ì›°ë§í„´","ë‹ˆì¹´ë¼ê³¼":"ë§ˆë‚˜ê³¼","ë‹ˆì œë¥´":"ë‹ˆì•„ë©”ì´","ë‚˜ì´ì§€ë¦¬ì•„":"ì•„ë¶€ì",
      "ë¶ë§ˆì¼€ë„ë‹ˆì•„":"ìŠ¤ì½”í˜","ë…¸ë¥´ì›¨ì´":"ì˜¤ìŠ¬ë¡œ","ì˜¤ë§Œ":"ë¬´ìŠ¤ì¹´íŠ¸","íŒŒí‚¤ìŠ¤íƒ„":"ì´ìŠ¬ë¼ë§ˆë°”ë“œ","íŒ”ë¼ìš°":"ì‘ê²Œë£°ë¬´ë“œ",
      "íŒŒë‚˜ë§ˆ":"íŒŒë‚˜ë§ˆì‹œí‹°","íŒŒí‘¸ì•„ë‰´ê¸°ë‹ˆ":"í¬íŠ¸ëª¨ë¥´ì¦ˆë¹„","íŒŒë¼ê³¼ì´":"ì•„ìˆœì‹œì˜¨","í˜ë£¨":"ë¦¬ë§ˆ","í•„ë¦¬í•€":"ë§ˆë‹ë¼",
      "í´ë€ë“œ":"ë°”ë¥´ìƒ¤ë°”","í¬ë¥´íˆ¬ê°ˆ":"ë¦¬ìŠ¤ë³¸","ì¹´íƒ€ë¥´":"ë„í•˜","ë£¨ë§ˆë‹ˆì•„":"ë¶€ì¿ ë ˆìŠˆí‹°","ëŸ¬ì‹œì•„":"ëª¨ìŠ¤í¬ë°”","ë¥´ì™„ë‹¤":"í‚¤ê°ˆë¦¬",
      "ì„¸ì¸íŠ¸í‚¤ì¸  ë„¤ë¹„ìŠ¤":"ë°”ìŠ¤í„°ë¥´","ì„¸ì¸íŠ¸ë£¨ì‹œì•„":"ìºìŠ¤íŠ¸ë¦¬ìŠ¤","ì„¸ì¸íŠ¸ë¹ˆì„¼íŠ¸ ê·¸ë ˆë‚˜ë”˜":"í‚¹ìŠ¤íƒ€ìš´","ì‚¬ëª¨ì•„":"ì•„í”¼ì•„",
      "ì‚°ë§ˆë¦¬ë…¸":"ì‚°ë§ˆë¦¬ë…¸","ìƒíˆ¬ë©” í”„ë¦°ì‹œí˜":"ìƒíˆ¬ë©”","ì‚¬ìš°ë””ì•„ë¼ë¹„ì•„":"ë¦¬ì•¼ë“œ","ì„¸ë„¤ê°ˆ":"ë‹¤ì¹´ë¥´","ì„¸ë¥´ë¹„ì•„":"ë² ì˜¤ê·¸ë¼ë“œ",
      "ì„¸ì´ì…¸":"ë¹…í† ë¦¬ì•„","ì‹œì—ë¼ë¦¬ì˜¨":"í”„ë¦¬íƒ€ìš´","ì‹±ê°€í¬ë¥´":"ì‹±ê°€í¬ë¥´","ìŠ¬ë¡œë°”í‚¤ì•„":"ë¸Œë¼í‹°ìŠ¬ë¼ë°”","ìŠ¬ë¡œë² ë‹ˆì•„":"ë¥˜ë¸”ë´ë‚˜",
      "ì†”ë¡œëª¬ì œë„":"í˜¸ë‹ˆì•„ë¼","ì†Œë§ë¦¬ì•„":"ëª¨ê°€ë””ìŠˆ","ë‚¨ì•„í”„ë¦¬ì¹´ê³µí™”êµ­":"í”„ë¦¬í† ë¦¬ì•„","ë‚¨ìˆ˜ë‹¨":"ì£¼ë°”","ìŠ¤í˜ì¸":"ë§ˆë“œë¦¬ë“œ",
      "ìŠ¤ë¦¬ë‘ì¹´":"ìŠ¤ë¦¬ìì•¼ì™€ë¥´ë°ë„¤í‘¸ë¼ì½”í…Œ","ìˆ˜ë‹¨":"ì¹´ë¥´íˆ¼","ìˆ˜ë¦¬ë‚¨":"íŒŒë¼ë§ˆë¦¬ë³´","ìŠ¤ì›¨ë´":"ìŠ¤í†¡í™€ë¦„","ìŠ¤ìœ„ìŠ¤":"ë² ë¥¸",
      "ì‹œë¦¬ì•„":"ë‹¤ë§ˆìŠ¤ì¿ ìŠ¤","íƒ€ì§€í‚¤ìŠ¤íƒ„":"ë‘ìƒ¨ë² ","íƒ„ìë‹ˆì•„":"ë„ë„ë§ˆ","íƒœêµ­":"ë°©ì½•","í† ê³ ":"ë¡œë©”","í†µê°€":"ëˆ„ì¿ ì•Œë¡œíŒŒ",
      "íŠ¸ë¦¬ë‹ˆë‹¤ë“œ í† ë°”ê³ ":"í¬íŠ¸ì˜¤ë¸ŒìŠ¤í˜ì¸","íŠ€ë‹ˆì§€":"íŠ€ë‹ˆìŠ¤","íŠ€ë¥´í‚¤ì˜ˆ":"ì•™ì¹´ë¼","íˆ¬ë¥´í¬ë©”ë‹ˆìŠ¤íƒ„":"ì•„ìŠˆí•˜ë°”íŠ¸",
      "íˆ¬ë°œë£¨":"í‘¸ë‚˜í‘¸í‹°","ìš°ê°„ë‹¤":"ìº„íŒ”ë¼","ìš°í¬ë¼ì´ë‚˜":"í‚¤ì´ìš°","ì•„ëì—ë¯¸ë¦¬íŠ¸":"ì•„ë¶€ë‹¤ë¹„","ì˜êµ­":"ëŸ°ë˜",
      "ë¯¸êµ­":"ì›Œì‹±í„´","ìš°ë£¨ê³¼ì´":"ëª¬í…Œë¹„ë°ì˜¤","ìš°ì¦ˆë² í‚¤ìŠ¤íƒ„":"íƒ€ìŠˆì¼„íŠ¸","ë°”ëˆ„ì•„íˆ¬":"í¬íŠ¸ë¹Œë¼","ë² ë„¤ìˆ˜ì—˜ë¼":"ì¹´ë¼ì¹´ìŠ¤",
      "ë² íŠ¸ë‚¨":"í•˜ë…¸ì´","ì˜ˆë©˜":"ì‚¬ë‚˜","ì ë¹„ì•„":"ë£¨ì‚¬ì¹´","ì§ë°”ë¸Œì›¨":"í•˜ë¼ë ˆ"
    };

    // ìƒíƒœ ë³€ìˆ˜
    let remainingCountries = Object.keys(quizData);
    let currentCountry = null;
    let wrongCount = 0;
    let score = 0;
    let gameOver = false;

    // íƒ€ì´ë¨¸ (2ë¶„ = 120ì´ˆ)
    const TOTAL_SECONDS = 120;
    let timeLeft = TOTAL_SECONDS;
    let timerId = null;
    let timerStarted = false;

    // DOM
    const input = document.getElementById("answerInput");
    const question = document.getElementById("question");
    const status = document.getElementById("status");
    const history = document.getElementById("history");
    const lives = document.getElementById("lives");
    const scoreBoard = document.getElementById("score");
    const rankingList = document.getElementById("rankingList");
    const timerEl = document.getElementById("timer");

    // ë­í‚¹ (localStorage)
    function loadRanking(){ const s = localStorage.getItem("capitalGameRanking"); return s? JSON.parse(s): []; }
    function saveRanking(r){ localStorage.setItem("capitalGameRanking", JSON.stringify(r)); }
    function updateRankingDisplay(){
      const ranking = loadRanking();
      rankingList.innerHTML = "";
      ranking.forEach(r => {
        const li = document.createElement("li"); li.textContent = `${r.name} - ${r.score}ê°œ`; rankingList.appendChild(li);
      });
    }
    function registerRanking(newScore){
      let ranking = loadRanking();
      if (ranking.length < 10 || newScore > ranking[ranking.length - 1].score) {
        const playerName = prompt("ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! 10ìœ„ ì•ˆì— ë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:");
        if (playerName) {
          ranking.push({ name: playerName, score: newScore });
          ranking.sort((a,b)=>b.score-a.score);
          ranking = ranking.slice(0,10);
          saveRanking(ranking);
        }
      }
      updateRankingDisplay();
    }

    // íƒ€ì´ë¨¸
    function fmt(sec){
      const m = Math.floor(sec/60); const s = sec%60;
      return `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
    }
    function updateTimerText(){ timerEl.textContent = `â± ë‚¨ì€ ì‹œê°„: ${fmt(timeLeft)}`; }
    function startTimer(){
      if (timerStarted) return;
      timerStarted = true;
      updateTimerText();
      timerId = setInterval(()=>{
        if (gameOver) { clearInterval(timerId); return; }
        timeLeft--;
        updateTimerText();
        if (timeLeft <= 0){
          clearInterval(timerId);
          timeUp();
        }
      }, 1000);
    }
    function timeUp(){
      status.textContent = "â° TIME OVER! ì‹œê°„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";
      gameOver = true;
      input.disabled = true;
      registerRanking(score);
    }

    // ê²Œì„
    function nextQuestion(){
      if (remainingCountries.length === 0){
        status.textContent = "ğŸ‰ ëª¨ë“  ë¬¸ì œë¥¼ ë‹¤ í’€ì—ˆìŠµë‹ˆë‹¤! GAME CLEAR!";
        gameOver = true; input.disabled = true; registerRanking(score); return;
      }
      const idx = Math.floor(Math.random() * remainingCountries.length);
      currentCountry = remainingCountries.splice(idx, 1)[0];
      question.textContent = `ğŸ‡ºğŸ‡³ "${currentCountry}"ì˜ ìˆ˜ë„ëŠ”?`;
      status.textContent = "";
      input.value = ""; input.focus();
    }

    function appendHistory(country, answer){
      const p = document.createElement("p");
      p.textContent = `${country} â ${answer || "(ë¬´ì‘ë‹µ)"} (ì •ë‹µ: ${quizData[country]})`;
      history.appendChild(p);
      // âœ… ìë™ ìŠ¤í¬ë¡¤ (í•­ìƒ ë§¨ ì•„ë˜ë¡œ)
      history.scrollTop = history.scrollHeight;
    }

    function endIfTooManyWrong(){
      if (wrongCount >= 10){
        status.textContent = "ğŸ’€ GAME OVER! (ì˜¤ë‹µ 10íšŒ)";
        gameOver = true; input.disabled = true; registerRanking(score); return true;
      }
      return false;
    }

    function checkAnswer(){
      if (gameOver) return;

      // ì²« ì…ë ¥ì—ì„œ íƒ€ì´ë¨¸ ë° ì²« ë¬¸ì œ ì‹œì‘
      if (!timerStarted){
        startTimer();
      }
      if (!currentCountry){
        nextQuestion();
        return;
      }

      const answer = input.value.trim();
      if (answer === quizData[currentCountry]){
        status.textContent = "âœ… ì •ë‹µì…ë‹ˆë‹¤!";
        score++; scoreBoard.textContent = `âœ… ì •ë‹µ ìˆ˜: ${score}ê°œ`;
      } else {
        status.textContent = "âŒ í‹€ë ¸ìŠµë‹ˆë‹¤!";
        wrongCount++; lives.textContent = `âŒ í‹€ë¦° íšŸìˆ˜: ${wrongCount} / 10`;
        if (endIfTooManyWrong()) return;
      }
      appendHistory(currentCountry, answer);
      nextQuestion();
    }

    input.addEventListener("keydown", (e)=>{
      if (e.key === "Enter") checkAnswer();
    });

    // ì´ˆê¸° í‘œì‹œ
    updateRankingDisplay();
    updateTimerText();
  </script>

  <script>
    // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ (PWA)
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js")
        .then(()=>console.log("Service Worker registered"))
        .catch(err=>console.error("SW registration failed:", err));
    }
  </script>
</body>
</html>
